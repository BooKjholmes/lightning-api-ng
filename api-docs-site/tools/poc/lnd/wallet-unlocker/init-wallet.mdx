---
sidebar_position: 1
---

# InitWallet

InitWallet is used when lnd is starting up for the first time to fully
initialize the daemon and its internal wallet. At the very least a wallet
password must be provided. This will be used to encrypt sensitive material
on disk.

In the case of a recovery scenario, the user can also specify their aezeed
mnemonic and passphrase. If set, then the daemon will use this prior state
to initialize its internal wallet.

Alternatively, this can be used along with the GenSeed RPC to obtain a
seed, then present it to the user. Once it has been verified by the user,
the seed can be fed into this RPC in order to commit the new wallet.

### gRPC

```
rpc InitWallet (InitWalletRequest) returns (InitWalletResponse);
```

### REST

| HTTP Method       | Path             |
| ----------------- | ---------------- |
| <Pill>POST</Pill> | `/v1/initwallet` |

## Messages

### InitWalletRequest

| Field                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | gRPC Type                                                  | REST Type | REST Placement |
| --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------- | --------- | -------------- |
| <MessageField name="wallet_password">wallet_password is the passphrase that should be used to encrypt the wallet. This MUST be at least 8 chars in length. After creation, this password is required to unlock the daemon. When using REST, this field must be encoded as base64.</MessageField>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | `byte`                                                     | `string`  | body           |
| <MessageField name="cipher_seed_mnemonic">cipher_seed_mnemonic is a 24-word mnemonic that encodes a prior aezeed cipher seed obtained by the user. This may have been generated by the GenSeed method, or be an existing seed. </MessageField>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | `array string`                                             | `array`   | body           |
| <MessageField name="aezeed_passphrase">aezeed_passphrase is an optional user provided passphrase that will be used to encrypt the generated aezeed cipher seed. When using REST, this field must be encoded as base64. </MessageField>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | `byte`                                                     | `string`  | body           |
| <MessageField name="recovery_window">recovery_window is an optional argument specifying the address lookahead when restoring a wallet seed. The recovery window applies to each individual branch of the BIP44 derivation paths. Supplying a recovery window of zero indicates that no addresses should be recovered, such after the first initialization of the wallet. </MessageField>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | `int32`                                                    | `integet` | body           |
| <MessageField name="channel_backups">channel_backups is an optional argument that allows clients to recover the settled funds within a set of channels. This should be populated if the user was unable to close out all channels and sweep funds before partial or total data loss occurred. If specified, then after on-chain recovery of funds, lnd begin to carry out the data loss recovery protocol in order to recover the funds in each channel from a remote force closed transaction. </MessageField>                                                                                                                                                                                                                                                                                                                                                                                           | [`ChanBackupSnapshot`](./grpc-messages#chanbackupsnapshot) | `object`  | body           |
| <MessageField name="stateless_init">stateless_init is an optional argument instructing the daemon NOT to create any \*.macaroon files in its filesystem. If this parameter is set, then the admin macaroon returned in the response MUST be stored by the caller of the RPC as otherwise all access to the daemon will be lost! </MessageField>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | `bool`                                                     | `boolean` | body           |
| <MessageField name="extended_master_key">extended_master_key is an alternative to specifying cipher_seed_mnemonic and aezeed_passphrase. Instead of deriving the master root key from the entropy of an aezeed cipher seed, the given extended master root key is used directly as the wallet's master key. This allows users to import/use a master key from another wallet. When doing so, lnd still uses its default SegWit only (BIP49/84) derivation paths and funds from custom/non-default derivation paths will not automatically appear in the on-chain wallet. Using an 'xprv' instead of an aezeed also has the disadvantage that the wallet's birthday is not known as that is an information that's only encoded in the aezeed, not the xprv. Therefore a birthday needs to be specified in extended_master_key_birthday_timestamp or a \"safe\" default value will be used. </MessageField> | `string`                                                   | `string`  | body           |
| <MessageField name="extended_master_key_birthday_timestamp">extended_master_key_birthday_timestamp is the optional unix timestamp in seconds to use as the wallet's birthday when using an extended master key to restore the wallet. lnd will only start scanning for funds in blocks that are after the birthday which can speed up the process significantly. If the birthday is not known, this should be left at its default value of 0 in which case lnd will start scanning from the first SegWit block (481824 on mainnet). </MessageField>                                                                                                                                                                                                                                                                                                                                                       | `uint64`                                                   | `integer` | body           |
| <MessageField name="watch_only">watch_only is the third option of initializing a wallet: by importing account xpubs only and therefore creating a watch-only wallet that does not contain any private keys. That means the wallet won't be able to sign for any of the keys and \_needs\* to be run with a remote signer that has the corresponding private keys and can serve signing RPC requests. </MessageField>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | [`WatchOnly`](./grpc-messages#watchonly)                   | `object`  | body           |

### InitWalletResponse

| Field                                                                                                                                                                                                                                                                                                                                                                                                   | gRPC Type | REST Type |
| ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | --------- | --------- |
| <MessageField name="admin_macaroon">The binary serialized admin macaroon that can be used to access the daemon after creating the wallet. If the stateless_init parameter was set to true, this is the ONLY copy of the macaroon and MUST be stored safely by the caller. Otherwise a copy of this macaroon is also persisted on disk by the daemon, together with other macaroon files.</MessageField> | `byte`    | `string`  |

## Code Samples

### gRPC

<Tabs groupId="code-samples">
<TabItem value="js" label="Javascript">


```js
const fs = require('fs');
const grpc = require('@grpc/grpc-js');
const protoLoader = require('@grpc/proto-loader');
const loaderOptions = {
  keepCase: true,
  longs: String,
  enums: String,
  defaults: true,
  oneofs: true
};
const packageDefinition = protoLoader.loadSync(['lightning.proto', 'walletunlocker.proto'], loaderOptions);
const lnrpc = grpc.loadPackageDefinition(packageDefinition).lnrpc;
const macaroon = fs.readFileSync("LND_DIR/data/chain/bitcoin/simnet/admin.macaroon").toString('hex');
process.env.GRPC_SSL_CIPHER_SUITES = 'HIGH+ECDSA';
const lndCert = fs.readFileSync('LND_DIR/tls.cert');
const sslCreds = grpc.credentials.createSsl(lndCert);
const walletUnlocker = new lnrpc.WalletUnlocker('localhost:10009', sslCreds);
let request = {
    wallet_password: <byte>,
    cipher_seed_mnemonic: <array string>,
    aezeed_passphrase: <byte>,
    recovery_window: <int32>,
    channel_backups: {
      single_chan_backups: {
        chan_backups: [
          {
            chan_point: {
              funding_txid_bytes: <byte>,
              funding_txid_str: <string>,
              output_index: <uint32>,
            },
            chan_backup: <byte>
          },
        ],
      },
      multi_chan_backup: {
        chan_points:[
          {
              funding_txid_bytes: <byte>,
              funding_txid_str: <string>,
              output_index: <uint32>,
            }
        ],
        multi_chan_backup: <byte>,
      }
    },
    stateless_init: <boolean>,
    extended_master_key: <string>,
    extended_master_key_birthday_timestamp: <string>,
    watch_only: {
      master_key_birthday_timestamp: <uint64>,
      master_key_fingerprint: <byte>,
      accounts: [
        {
          purpose: <int32>,
          coin_type: <int32>,
          account: <int32>,
          xpub: <string>,
        }
      ],
    },
};
walletUnlocker.initWallet(request, function(err, response) {
  console.log(response);
});
// Console output:
//  {
//      "admin_macaroon": <bytes>,
//  }
```

</TabItem>
<TabItem value="py" label="Python">


```py
>>> import codecs, grpc, os
>>> # Generate the following 2 modules by compiling the lnrpc/walletunlocker.proto with the grpcio-tools.
>>> # See https://github.com/lightningnetwork/lnd/blob/master/docs/grpc/python.md for instructions.
>>> import walletunlocker_pb2 as lnrpc, walletunlocker_pb2_grpc as walletunlockerstub
>>> os.environ['GRPC_SSL_CIPHER_SUITES'] = 'HIGH+ECDSA'
>>> cert = open('LND_DIR/tls.cert', 'rb').read()
>>> ssl_creds = grpc.ssl_channel_credentials(cert)
>>> channel = grpc.secure_channel('localhost:10009', ssl_creds)
>>> stub = walletunlockerstub.WalletUnlockerStub(channel)
>>> request = lnrpc.InitWalletRequest(
        'wallet_password': base64.b64encode(<byte>).decode(),
        'cipher_seed_mnemonic': <array string>,
        'aezeed_passphrase': base64.b64encode(<byte>).decode(),
        'recovery_window': <int32>,
        'channel_backups': {
          'single_chan_backups': {
            'chan_backups': [
              {
                'chan_point': {
                  'funding_txid_bytes': <byte>,
                  'funding_txid_str': <string>,
                  'output_index': <uint32>,
                },
                'chan_backup': <byte>
              },
            ],
          },
          'multi_chan_backup': {
            'chan_points':[
              {
                  funding_txid_bytes: <byte>,
                  funding_txid_str: <string>,
                  output_index: <uint32>,
                }
            ],
            'multi_chan_backup': <byte>,
          }
        },
        'stateless_init': <boolean>,
        'extended_master_key': <string>,
        'extended_master_key_birthday_timestamp': <string>,
        'watch_only': {
          'master_key_birthday_timestamp': <uint64>,
          'master_key_fingerprint': <byte>,
          'accounts': [
            {
              'purpose': <int32>,
              'coin_type': <int32>,
              'account': <int32>,
              'xpub': <string>,
            }
          ],
        },
    )
>>> response = stub.InitWallet(request)
>>> print(response)
{
    "admin_macaroon": <bytes>,
}
```

</TabItem>
<TabItem value="bash" label="Shell">


```bash
# Shell sample code is not available in the docs yet.
# Please open a PR to update the comments in the proto file:
# https://github.com/lightningnetwork/lnd/blob/master/lnrpc/walletunlocker.proto
```

</TabItem>
<TabItem value="go" label="Go">


```
// TODO: Go Sample Code
```

</TabItem>
<TabItem value="java" label="Java">


```
// TODO: Java Sample Code
```

</TabItem>
<TabItem value="csharp" label="C#">


```
// TODO: C# Sample Code
```

</TabItem>
</Tabs>


### REST

<Tabs groupId="code-samples">
<TabItem value="js" label="Javascript">


```js
const fs = require('fs');
const request = require('request');
let requestBody = {
    wallet_password: <byte>,
    cipher_seed_mnemonic: <array string>,
    aezeed_passphrase: <byte>,
    recovery_window: <int32>,
    channel_backups: {
      single_chan_backups: {
        chan_backups: [
          {
            chan_point: {
              funding_txid_bytes: <byte>,
              funding_txid_str: <string>,
              output_index: <uint32>,
            },
            chan_backup: <byte>
          },
        ],
      },
      multi_chan_backup: {
        chan_points:[
          {
              funding_txid_bytes: <byte>,
              funding_txid_str: <string>,
              output_index: <uint32>,
            }
        ],
        multi_chan_backup: <byte>,
      }
    },
    stateless_init: <boolean>,
    extended_master_key: <string>,
    extended_master_key_birthday_timestamp: <string>,
    watch_only: {
      master_key_birthday_timestamp: <uint64>,
      master_key_fingerprint: <byte>,
      accounts: [
        {
          purpose: <int32>,
          coin_type: <int32>,
          account: <int32>,
          xpub: <string>,
        }
      ],
    },
}
let options = {
  url: 'https://localhost:8080/v1/initwallet',
  // Work-around for self-signed certificates.
  rejectUnauthorized: false,
  json: true,
  form: JSON.stringify(requestBody),
}
request.post(options, function(error, response, body) {
  console.log(body);
});
// Console output:
//  {
//      "admin_macaroon": <byte>,
//  }
```

</TabItem>
<TabItem value="py" label="Python">


```py
>>> import base64, codecs, json, requests
>>> url = 'https://localhost:8080/v1/initwallet'
>>> cert_path = 'LND_DIR/tls.cert'
>>> data = {
        'wallet_password': base64.b64encode(<byte>).decode(),
        'cipher_seed_mnemonic': <array string>,
        'aezeed_passphrase': base64.b64encode(<byte>).decode(),
        'recovery_window': <int32>,
        'channel_backups': {
          'single_chan_backups': {
            'chan_backups': [
              {
                'chan_point': {
                  'funding_txid_bytes': <byte>,
                  'funding_txid_str': <string>,
                  'output_index': <uint32>,
                },
                'chan_backup': <byte>
              },
            ],
          },
          'multi_chan_backup': {
            'chan_points':[
              {
                  funding_txid_bytes: <byte>,
                  funding_txid_str: <string>,
                  output_index: <uint32>,
                }
            ],
            'multi_chan_backup': <byte>,
          }
        },
        'stateless_init': <boolean>,
        'extended_master_key': <string>,
        'extended_master_key_birthday_timestamp': <string>,
        'watch_only': {
          'master_key_birthday_timestamp': <uint64>,
          'master_key_fingerprint': <byte>,
          'accounts': [
            {
              'purpose': <int32>,
              'coin_type': <int32>,
              'account': <int32>,
              'xpub': <string>,
            }
          ],
        },
    }
>>> r = requests.post(url, verify=cert_path, data=json.dumps(data))
>>> print(r.json())
{
    "admin_macaroon": <byte>,
}
```

</TabItem>
<TabItem value="bash" label="Shell">


```bash
$ MACAROON_HEADER="Grpc-Metadata-macaroon: $(xxd -ps -u -c 1000 $LND_DIR/data/chain/bitcoin/simnet/admin.macaroon)"
$ curl -X GET --cacert $LND_DIR/tls.cert --header "$MACAROON_HEADER" https://localhost:8080/v1/genseed
{
    "cipher_seed_mnemonic": <array string>,
    "enciphered_seed": <byte>,
}
```

</TabItem>
<TabItem value="go" label="Go">


```
// TODO: Go Sample Code
```

</TabItem>
<TabItem value="java" label="Java">


```
// TODO: Java Sample Code
```

</TabItem>
<TabItem value="csharp" label="C#">


```
// TODO: C# Sample Code
```

</TabItem>
</Tabs>

