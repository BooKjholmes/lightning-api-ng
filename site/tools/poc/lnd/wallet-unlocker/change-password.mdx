---
sidebar_position: 4
---

# ChangePassword

lncli: `changepassword`

ChangePassword changes the password of the encrypted wallet. This will automatically unlock the wallet database if successful.

## gRPC

```
rpc ChangePassword (ChangePasswordRequest) returns (ChangePasswordResponse);
```

### ChangePasswordRequest

| Field                                                                                                                                                                                                                                                                                                                                          | Type    |
| ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------- |
| <MessageField name="current_password">current_password should be the current valid passphrase used to unlock the daemon. When using REST, this field must be encoded as base64.</MessageField>                                                                                                                                                 | `bytes` |
| <MessageField name="new_password">new_password should be the new passphrase that will be needed to unlock the daemon. When using REST, this field must be encoded as base64.</MessageField>                                                                                                                                                    | `bytes` |
| <MessageField name="stateless_init">stateless_init is an optional argument instructing the daemon NOT to create any \*.macaroon files in its filesystem. If this parameter is set, then the admin macaroon returned in the response MUST be stored by the caller of the RPC as otherwise all access to the daemon will be lost!</MessageField> | `bool`  |
| <MessageField name="new_macaroon_root_key">new_macaroon_root_key is an optional argument instructing the daemon to rotate the macaroon root key when set to true. This will invalidate all previously generated macaroons.</MessageField>                                                                                                      | `bool`  |

### ChangePasswordResponse

| Field                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | Type    |
| ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------- |
| <MessageField name="admin_macaroon">The binary serialized admin macaroon that can be used to access the daemon after rotating the macaroon root key. If both the stateless_init and new_macaroon_root_key parameter were set to true, this is the ONLY copy of the macaroon that was created from the new root key and MUST be stored safely by the caller. Otherwise a copy of this macaroon is also persisted on disk by the daemon, together with other macaroon files.</MessageField> | `bytes` |

### Code Samples

<Tabs groupId="code-samples">
<TabItem value="js" label="Javascript">


```js
const fs = require('fs');
const grpc = require('@grpc/grpc-js');
const protoLoader = require('@grpc/proto-loader');
const loaderOptions = {
  keepCase: true,
  longs: String,
  enums: String,
  defaults: true,
  oneofs: true
};
const packageDefinition = protoLoader.loadSync(['lightning.proto', 'walletunlocker.proto'], loaderOptions);
const lnrpc = grpc.loadPackageDefinition(packageDefinition).lnrpc;
const macaroon = fs.readFileSync("LND_DIR/data/chain/bitcoin/simnet/admin.macaroon").toString('hex');
process.env.GRPC_SSL_CIPHER_SUITES = 'HIGH+ECDSA';
const lndCert = fs.readFileSync('LND_DIR/tls.cert');
const sslCreds = grpc.credentials.createSsl(lndCert);
const walletUnlocker = new lnrpc.WalletUnlocker('localhost:10009', sslCreds);
let request = {
  current_password: <bytes>,
  new_password: <bytes>,
  stateless_init: <bool>,
  new_macaroon_root_key: <bool>,
};
walletUnlocker.changePassword(request, function(err, response) {
  console.log(response);
});
// Console output:
//  {
//      "admin_macaroon": <bytes>,
//  }
```

</TabItem>
<TabItem value="py" label="Python">


```py
>>> import codecs, grpc, os
>>> # Generate the following 2 modules by compiling the lnrpc/walletunlocker.proto with the grpcio-tools.
>>> # See https://github.com/lightningnetwork/lnd/blob/master/docs/grpc/python.md for instructions.
>>> import walletunlocker_pb2 as lnrpc, walletunlocker_pb2_grpc as walletunlockerstub
>>> os.environ['GRPC_SSL_CIPHER_SUITES'] = 'HIGH+ECDSA'
>>> cert = open('LND_DIR/tls.cert', 'rb').read()
>>> ssl_creds = grpc.ssl_channel_credentials(cert)
>>> channel = grpc.secure_channel('localhost:10009', ssl_creds)
>>> stub = walletunlockerstub.WalletUnlockerStub(channel)
>>> request = lnrpc.ChangePasswordRequest(
        current_password=<bytes>,
        new_password=<bytes>,
        stateless_init=<bool>,
        new_macaroon_root_key=<bool>,
    )
>>> response = stub.ChangePassword(request)
>>> print(response)
{
    "admin_macaroon": <bytes>,
}
```

</TabItem>
<TabItem value="bash" label="Shell">


```bash
# The changepassword command is used to Change lnd's encrypted wallet's
# password. It will automatically unlock the daemon if the password change
# is successful.
# If one did not specify a password for their wallet (running lnd with
# --noseedbackup), one must restart their daemon without
# --noseedbackup and use this command. The "current password" field
# should be left empty.
# If the daemon was originally initialized stateless, then the
# --stateless_init flag needs to be set for the change password request
# as well! Otherwise the daemon will generate unencrypted macaroon files
# in its file system again and possibly leak sensitive information.
# Changing the password will by default not change the macaroon root key
# (just re-encrypt the macaroon database with the new password). So all
# macaroons will still be valid.
# If one wants to make sure that all previously created macaroons are
# invalidated, a new macaroon root key can be generated by using the
# --new_mac_root_key flag.
# After a successful password change with the --stateless_init flag set,
# the current or new admin macaroon is returned binary serialized in the
# answer. This answer MUST then be stored somewhere, otherwise
# all access to the RPC server will be lost and the wallet must be re-
# created to re-gain access. If the --save_to parameter is set, the
# macaroon is saved to this file, otherwise it is printed to standard out.

$ lncli changepassword [command options] [arguments...]

# --stateless_init    do not create any macaroon files in the file system of the daemon
# --save_to value     save returned admin macaroon to this file
# --new_mac_root_key  rotate the macaroon root key resulting in all previously created macaroons to be invalidated
```

</TabItem>
<TabItem value="go" label="Go">


```
// TODO: Go Sample Code
```

</TabItem>
<TabItem value="java" label="Java">


```
// TODO: Java Sample Code
```

</TabItem>
<TabItem value="csharp" label="C#">


```
// TODO: C# Sample Code
```

</TabItem>
</Tabs>


## REST

| HTTP Method       | Path                 |
| ----------------- | -------------------- |
| <Pill>POST</Pill> | `/v1/changepassword` |

### lnrpcChangePasswordRequest

| Field                                                                                                                                                                                                                                                                                                                                          | Type      | Format    | Placement |
| ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | --------- | --------- | --------- |
| <MessageField name="current_password">current_password should be the current valid passphrase used to unlock the daemon. When using REST, this field must be encoded as base64.</MessageField>                                                                                                                                                 | `string`  | `byte`    | body      |
| <MessageField name="new_macaroon_root_key">new_macaroon_root_key is an optional argument instructing the daemon to rotate the macaroon root key when set to true. This will invalidate all previously generated macaroons.</MessageField>                                                                                                      | `boolean` | `boolean` | body      |
| <MessageField name="new_password">new_password should be the new passphrase that will be needed to unlock the daemon. When using REST, this field must be encoded as base64.</MessageField>                                                                                                                                                    | `string`  | `byte`    | body      |
| <MessageField name="stateless_init">stateless_init is an optional argument instructing the daemon NOT to create any \*.macaroon files in its filesystem. If this parameter is set, then the admin macaroon returned in the response MUST be stored by the caller of the RPC as otherwise all access to the daemon will be lost!</MessageField> | `boolean` | `boolean` | body      |

### lnrpcChangePasswordResponse

| Field                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | Type     | Format |
| ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | -------- | ------ |
| <MessageField name="admin_macaroon">The binary serialized admin macaroon that can be used to access the daemon after rotating the macaroon root key. If both the stateless_init and new_macaroon_root_key parameter were set to true, this is the ONLY copy of the macaroon that was created from the new root key and MUST be stored safely by the caller. Otherwise a copy of this macaroon is also persisted on disk by the daemon, together with other macaroon files.</MessageField> | `string` | `byte` |

### Code Samples

<Tabs groupId="code-samples">
<TabItem value="js" label="Javascript">


```js
const fs = require('fs');
const request = require('request');
let requestBody = {
    current_password: <byte>,
    new_password: <byte>,
    stateless_init: <boolean>,
    new_macaroon_root_key: <boolean>,
}
let options = {
  url: 'https://localhost:8080/v1/changepassword',
  // Work-around for self-signed certificates.
  rejectUnauthorized: false,
  json: true,
  form: JSON.stringify(requestBody),
}
request.post(options, function(error, response, body) {
  console.log(body);
});
// Console output:
//  {
//      "admin_macaroon": <byte>,
//  }
```

</TabItem>
<TabItem value="py" label="Python">


```py
>>> import base64, codecs, json, requests
>>> url = 'https://localhost:8080/v1/changepassword'
>>> cert_path = 'LND_DIR/tls.cert'
>>> data = {
        'current_password': base64.b64encode(<byte>).decode(),
        'new_password': base64.b64encode(<byte>).decode(),
        'stateless_init': <boolean>,
        'new_macaroon_root_key': <boolean>,
    }
>>> r = requests.post(url, verify=cert_path, data=json.dumps(data))
>>> print(r.json())
{
    "admin_macaroon": <byte>,
}
```

</TabItem>
<TabItem value="bash" label="Shell">


```bash
$ MACAROON_HEADER="Grpc-Metadata-macaroon: $(xxd -ps -u -c 1000 $LND_DIR/data/chain/bitcoin/simnet/admin.macaroon)"
$ curl -X POST --cacert $LND_DIR/tls.cert --header "$MACAROON_HEADER" https://localhost:8080/v1/changepassword  \
    -d '{ "current_password":<byte>,"new_password":<byte>,"stateless_init":<boolean>,"new_macaroon_root_key":<boolean>, }'
{
    "admin_macaroon": <byte>,
}
```

</TabItem>
<TabItem value="go" label="Go">


```
// TODO: Go Sample Code
```

</TabItem>
<TabItem value="java" label="Java">


```
// TODO: Java Sample Code
```

</TabItem>
<TabItem value="csharp" label="C#">


```
// TODO: C# Sample Code
```

</TabItem>
</Tabs>

